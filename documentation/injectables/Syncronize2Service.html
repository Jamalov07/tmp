<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>tmp documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">tmp documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">












<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >Syncronize2Service</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/syncronize/syncron.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#accessToken" >accessToken</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#baseUrl" >baseUrl</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#password" >password</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#phone" >phone</a>
                            </li>
                            <li>
                                <a href="#round" >round</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#fetchAllPages" >fetchAllPages</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#getHeaders" >getHeaders</a>
                            </li>
                            <li>
                                <a href="#onModuleInit" >onModuleInit</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#signIn" >signIn</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#sync" >sync</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(syncronizeRepository: <a href="../injectables/SyncronizeRepository.html" target="_self">SyncronizeRepository</a>, prisma: <a href="../injectables/PrismaService.html" target="_self">PrismaService</a>, configService: ConfigService)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="36" class="link-to-prism">src/modules/syncronize/syncron.service.ts:36</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>syncronizeRepository</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/SyncronizeRepository.html" target="_self" >SyncronizeRepository</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>prisma</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/PrismaService.html" target="_self" >PrismaService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>configService</td>
                                                  
                                                        <td>
                                                                    <code>ConfigService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="fetchAllPages"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>fetchAllPages</b></span>
                        <a href="#fetchAllPages"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>fetchAllPages(endpoint: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="69"
                                    class="link-to-prism">src/modules/syncronize/syncron.service.ts:69</a></div>
                        </td>
                    </tr>

                    <tr>
                        <td class="col-md-4">
                            <b>Type parameters :</b>
                            <ul class="type-parameters">
                                    <li>T</li>
                            </ul>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>endpoint</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;T[]&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getHeaders"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>getHeaders</b></span>
                        <a href="#getHeaders"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getHeaders()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="62"
                                    class="link-to-prism">src/modules/syncronize/syncron.service.ts:62</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>{ &#x27;Content-Type&#x27;: string; Authorization: string; }</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="onModuleInit"></a>
                    <span class="name">
                        <span ><b>onModuleInit</b></span>
                        <a href="#onModuleInit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>onModuleInit()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="44"
                                    class="link-to-prism">src/modules/syncronize/syncron.service.ts:44</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="signIn"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>signIn</b></span>
                        <a href="#signIn"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>signIn()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="52"
                                    class="link-to-prism">src/modules/syncronize/syncron.service.ts:52</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sync"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>sync</b></span>
                        <a href="#sync"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>sync()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="93"
                                    class="link-to-prism">src/modules/syncronize/syncron.service.ts:93</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section data-compodoc="block-properties">
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="accessToken"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>accessToken</b></span>
                        <a href="#accessToken"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>&#x27;&#x27;</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="36" class="link-to-prism">src/modules/syncronize/syncron.service.ts:36</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="baseUrl"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>baseUrl</b></span>
                        <a href="#baseUrl"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/modules/syncronize/syncron.service.ts:33</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="password"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>password</b></span>
                        <a href="#password"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="35" class="link-to-prism">src/modules/syncronize/syncron.service.ts:35</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="phone"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>phone</b></span>
                        <a href="#phone"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/modules/syncronize/syncron.service.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="round"></a>
                    <span class="name">
                        <span ><b>round</b></span>
                        <a href="#round"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>() &#x3D;&gt; {...}</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="50" class="link-to-prism">src/modules/syncronize/syncron.service.ts:50</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, OnModuleInit } from &#x27;@nestjs/common&#x27;
import { SyncronizeRepository } from &#x27;./syncronize.repository&#x27;
import axios from &#x27;axios&#x27;
import { PrismaService } from &#x27;../shared&#x27;
import { SellingStatusEnum, ServiceTypeEnum, UserTypeEnum } from &#x27;@prisma/client&#x27;
import { createResponse } from &#x27;../../common&#x27;
import { ConfigService } from &#x27;@nestjs/config&#x27;
import * as bcrypt from &#x27;bcryptjs&#x27;
import { v4 as uuidv4 } from &#x27;uuid&#x27;
import {
	Arrival,
	Client,
	IArrival,
	IClient,
	IClientPayment,
	IProduct,
	IReturning,
	ISelling,
	IStaff,
	IStaffPayment,
	ISupplier,
	ISupplierPayment,
	Product,
	Returning,
	Selling,
	Staff,
	Supplier,
} from &#x27;./interfaces&#x27;
import { Decimal } from &#x27;@prisma/client/runtime/library&#x27;

@Injectable()
export class Syncronize2Service implements OnModuleInit {
	private baseUrl: string
	private phone: string
	private password: string
	private accessToken &#x3D; &#x27;&#x27;

	constructor(
		private readonly syncronizeRepository: SyncronizeRepository,
		private readonly prisma: PrismaService,
		private readonly configService: ConfigService,
	) {}

	onModuleInit() {
		this.baseUrl &#x3D; this.configService.getOrThrow(&#x27;old-service.baseUrl&#x27;)
		this.phone &#x3D; this.configService.getOrThrow(&#x27;old-service.user&#x27;)
		this.password &#x3D; this.configService.getOrThrow(&#x27;old-service.password&#x27;)
	}

	round &#x3D; (num: number, digits &#x3D; 2) &#x3D;&gt; Math.round((num + Number.EPSILON) * Math.pow(10, digits)) / Math.pow(10, digits)

	private async signIn() {
		const url &#x3D; &#x60;${this.baseUrl}/admin/sign-in&#x60;
		const response &#x3D; await axios.post(
			url,
			{ phone: this.phone, password: this.password },
			{ headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; }, timeout: 5000, maxRedirects: 1, proxy: false },
		)
		this.accessToken &#x3D; response.data.accessToken
	}

	private getHeaders() {
		return {
			&#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
			Authorization: &#x60;Bearer ${this.accessToken}&#x60;,
		}
	}

	private async fetchAllPages&lt;T&gt;(endpoint: string): Promise&lt;T[]&gt; {
		const allData: T[] &#x3D; []
		const firstPageUrl &#x3D; &#x60;${this.baseUrl}${endpoint}?pageSize&#x3D;100&amp;pageNumber&#x3D;1&#x60;
		const firstPage &#x3D; await axios.get(firstPageUrl, {
			headers: this.getHeaders(),
			timeout: 5000,
			maxRedirects: 1,
			proxy: false,
		})

		for (let i &#x3D; 1; i &lt;&#x3D; firstPage.data.pageCount; i++) {
			const url &#x3D; &#x60;${this.baseUrl}${endpoint}?pageSize&#x3D;100&amp;pageNumber&#x3D;${i}&#x60;
			const res &#x3D; await axios.get(url, {
				headers: this.getHeaders(),
				timeout: 5000,
				maxRedirects: 1,
				proxy: false,
			})
			allData.push(...res.data.data)
		}

		return allData
	}

	async sync() {
		console.log(&#x27;synchronization started&#x27;)
		await this.prisma.arrivalModel.deleteMany({})
		await this.prisma.botUserModel.deleteMany({})
		await this.prisma.paymentModel.deleteMany({})
		await this.prisma.productModel.deleteMany({})
		await this.prisma.productMVModel.deleteMany({})
		await this.prisma.returningModel.deleteMany({})
		await this.prisma.sellingModel.deleteMany({})
		await this.prisma.userModel.deleteMany({})

		await this.signIn()

		console.log(&#x27;started&#x27;)

		const [
			staffsRemote,
			suppliersRemote,
			clientsRemote,
			productsRemote,
			staffPaymentsRemote,
			supplierPaymentRemote,
			clientPaymentRemote,
			sellingsRemote,
			arrivalsRemote,
			returningsRemote,
		] &#x3D; await Promise.all([
			this.fetchAllPages&lt;IStaff&gt;(&#x27;/admin&#x27;),
			this.fetchAllPages&lt;ISupplier&gt;(&#x27;/user/supplier&#x27;),
			this.fetchAllPages&lt;IClient&gt;(&#x27;/user/client&#x27;),
			this.fetchAllPages&lt;IProduct&gt;(&#x27;/product&#x27;),
			this.fetchAllPages&lt;IStaffPayment&gt;(&#x27;/employeePayment&#x27;),
			this.fetchAllPages&lt;ISupplierPayment&gt;(&#x27;/incomingOrderPayment&#x27;),
			this.fetchAllPages&lt;IClientPayment&gt;(&#x27;/payment&#x27;),
			this.fetchAllPages&lt;ISelling&gt;(&#x27;/Order&#x27;),
			this.fetchAllPages&lt;IArrival&gt;(&#x27;/incomingOrder&#x27;),
			this.fetchAllPages&lt;IReturning&gt;(&#x27;/returned-order&#x27;),
		])

		console.log(&#x27;get all success&#x27;)

		const staffs: Record&lt;string, Staff&gt; &#x3D; {}
		staffsRemote.forEach((staff) &#x3D;&gt; {
			staffs[staff.id] &#x3D; {
				id: staff.id,
				phone: staff.phone.trim(),
				fullname: staff.name.trim(),
				password: bcrypt.hashSync(staff.phone.trim(), 7),
				type: UserTypeEnum.staff,
				createdAt: staff.createdAt,
				balance: new Decimal(0),
				debt: new Decimal(0),
				payments: [],
			}
		})

		const suppliers: Record&lt;string, Supplier&gt; &#x3D; {}
		suppliersRemote.forEach((supplier) &#x3D;&gt; {
			suppliers[supplier.id] &#x3D; {
				id: supplier.id,
				phone: supplier.phone.trim(),
				fullname: supplier.name.trim(),
				password: bcrypt.hashSync(supplier.phone.trim(), 7),
				type: UserTypeEnum.supplier,
				createdAt: supplier.createdAt,
				payments: [],
				balance: new Decimal(0),
				debt: new Decimal(supplier.debt),
			}
		})

		const clients: Record&lt;string, Client&gt; &#x3D; {}
		clientsRemote.forEach((client) &#x3D;&gt; {
			clients[client.id] &#x3D; {
				id: client.id,
				phone: client.phone.trim(),
				fullname: client.name.trim(),
				password: bcrypt.hashSync(client.phone.trim(), 7),
				type: UserTypeEnum.client,
				createdAt: client.createdAt,
				balance: new Decimal(0),
				debt: new Decimal(client.debt),
				payments: [],
			}
		})

		const products: Record&lt;string, Product&gt; &#x3D; {}
		productsRemote.forEach((product) &#x3D;&gt; {
			products[product.id] &#x3D; {
				id: product.id,
				name: product.name.trim(),
				cost: new Decimal(product.cost),
				count: product.count,
				price: new Decimal(product.selling_price),
				minAmount: product.min_amount,
				createdAt: product.createdAt,
			}
		})

		staffPaymentsRemote.forEach((staffPayment) &#x3D;&gt; {
			if (!staffs[staffPayment.employee.id]) {
				staffs[staffPayment.employee.id] &#x3D; {
					id: staffPayment.employee.id,
					createdAt: new Date(),
					fullname: staffPayment.employee.name.trim(),
					phone: staffPayment.employee.phone.trim(),
					password: bcrypt.hashSync(staffPayment.employee.phone.trim(), 7),
					type: UserTypeEnum.staff,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			staffs[staffPayment.employee.id].balance &#x3D; staffs[staffPayment.employee.id].balance.plus(staffPayment.sum)
			staffs[staffPayment.employee.id].payments.push({
				id: staffPayment.id,
				type: ServiceTypeEnum.staff,
				userId: staffPayment.employee.id,
				staffId: staffPayment.employee.id,
				total: new Decimal(staffPayment.sum),
				sum: new Decimal(staffPayment.sum),
				description: staffPayment.description,
				createdAt: staffPayment.createdAt,
			})
		})

		let mainStaff &#x3D; Object.values(staffs).find((staff) &#x3D;&gt; staff.phone &#x3D;&#x3D;&#x3D; this.phone)
		if (!mainStaff) {
			mainStaff &#x3D; Object.values(staffs)[0]
		}

		const partialArrivals: Partial&lt;Arrival&gt;[] &#x3D; []

		supplierPaymentRemote.forEach((supplierPayment) &#x3D;&gt; {
			if (!suppliers[supplierPayment.supplier.id]) {
				suppliers[supplierPayment.supplier.id] &#x3D; {
					id: supplierPayment.supplier.id,
					createdAt: new Date(),
					fullname: supplierPayment.supplier.name.trim(),
					phone: supplierPayment.supplier.phone.trim(),
					password: bcrypt.hashSync(supplierPayment.supplier.phone.trim(), 7),
					type: UserTypeEnum.supplier,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			if (!supplierPayment.order) {
				suppliers[supplierPayment.supplier.id].balance &#x3D; suppliers[supplierPayment.supplier.id].balance.plus(supplierPayment.totalPay)
				suppliers[supplierPayment.supplier.id].payments.push({
					id: supplierPayment.id,
					type: ServiceTypeEnum.supplier,
					userId: supplierPayment.supplier.id,
					staffId: mainStaff.id,
					total: new Decimal(supplierPayment.totalPay),
					card: new Decimal(supplierPayment.card),
					cash: new Decimal(supplierPayment.cash),
					other: new Decimal(supplierPayment.other),
					transfer: new Decimal(supplierPayment.transfer),
					description: supplierPayment.description,
					createdAt: supplierPayment.createdAt,
				})
			} else {
				partialArrivals.push({
					id: supplierPayment.order.id,
					totalPrice: new Decimal(supplierPayment.order.sum),
					payment: {
						id: supplierPayment.id,
						type: ServiceTypeEnum.arrival,
						userId: supplierPayment.supplier.id,
						staffId: mainStaff.id,
						total: new Decimal(supplierPayment.totalPay),
						card: new Decimal(supplierPayment.card),
						cash: new Decimal(supplierPayment.cash),
						other: new Decimal(supplierPayment.other),
						transfer: new Decimal(supplierPayment.transfer),
						description: supplierPayment.description,
						createdAt: supplierPayment.createdAt,
					},
				})
			}
		})

		const partialSellings: Partial&lt;Selling&gt;[] &#x3D; []

		clientPaymentRemote.forEach((clientPayment) &#x3D;&gt; {
			if (!clients[clientPayment.client.id]) {
				clients[clientPayment.client.id] &#x3D; {
					id: clientPayment.client.id,
					createdAt: new Date(),
					fullname: clientPayment.client.name.trim(),
					phone: clientPayment.client.phone.trim(),
					password: bcrypt.hashSync(clientPayment.client.phone.trim(), 7),
					type: UserTypeEnum.client,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			if (!clientPayment.order) {
				clients[clientPayment.client.id].balance &#x3D; clients[clientPayment.client.id].balance.plus(clientPayment.totalPay)
				clients[clientPayment.client.id].payments.push({
					id: clientPayment.id,
					type: ServiceTypeEnum.client,
					userId: clientPayment.client.id,
					staffId: mainStaff.id,
					total: new Decimal(clientPayment.totalPay),
					card: new Decimal(clientPayment.card),
					cash: new Decimal(clientPayment.cash),
					other: new Decimal(clientPayment.other),
					transfer: new Decimal(clientPayment.transfer),
					description: clientPayment.description,
					createdAt: clientPayment.createdAt,
				})
			} else {
				partialSellings.push({
					id: clientPayment.order.id,
					totalPrice: new Decimal(clientPayment.order.sum),
					payment: {
						id: clientPayment.id,
						type: ServiceTypeEnum.selling,
						userId: clientPayment.client.id,
						staffId: mainStaff.id,
						total: new Decimal(clientPayment.totalPay),
						card: new Decimal(clientPayment.card),
						cash: new Decimal(clientPayment.cash),
						other: new Decimal(clientPayment.other),
						transfer: new Decimal(clientPayment.transfer),
						description: clientPayment.description,
						createdAt: clientPayment.createdAt,
					},
				})
			}
		})

		const sellingsObject: Record&lt;string, Selling&gt; &#x3D; {}
		sellingsRemote.forEach((selling) &#x3D;&gt; {
			if (!clients[selling.client.id]) {
				clients[selling.client.id] &#x3D; {
					id: selling.client.id,
					createdAt: new Date(),
					fullname: selling.client.name.trim(),
					phone: selling.client.phone.trim(),
					password: bcrypt.hashSync(selling.client.phone.trim(), 7),
					type: UserTypeEnum.client,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(selling.client.debt),
					deletedAt: new Date(),
				}
			}

			if (!staffs[selling.seller.id]) {
				staffs[selling.seller.id] &#x3D; {
					id: selling.seller.id,
					createdAt: new Date(),
					fullname: selling.seller.name.trim(),
					phone: selling.seller.phone.trim(),
					password: bcrypt.hashSync(selling.seller.phone.trim(), 7),
					type: UserTypeEnum.staff,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			const sellingProducts: {
				id: string
				productId: string
				type: ServiceTypeEnum
				totalPrice: Decimal
				count: number
				price: Decimal
				staffId: string
				createdAt: Date
				sellingId: string
			}[] &#x3D; []

			let totalPrice &#x3D; new Decimal(0)
			selling.products.forEach((product) &#x3D;&gt; {
				if (!products[product.product.id]) {
					products[product.product.id] &#x3D; {
						id: product.product.id,
						count: product.product.count,
						name: product.product.name,
						cost: new Decimal(product.cost),
						price: new Decimal(product.price),
						minAmount: 1,
						createdAt: new Date(),
					}
				}
				totalPrice &#x3D; totalPrice.plus(new Decimal(product.price).mul(product.count))
				sellingProducts.push({
					id: product.id,
					sellingId: selling.id,
					count: product.count,
					price: new Decimal(product.price),
					createdAt: product.createdAt,
					type: ServiceTypeEnum.selling,
					staffId: staffs[selling.seller.id].id,
					totalPrice: new Decimal(product.price).mul(product.count),
					productId: products[product.product.id].id,
				})
			})

			sellingsObject[selling.id] &#x3D; {
				id: selling.id,
				clientId: clients[selling.client.id].id,
				staffId: staffs[selling.seller.id].id,
				date: selling.sellingDate,
				status: selling.accepted ? SellingStatusEnum.accepted : SellingStatusEnum.notaccepted,
				totalPrice: totalPrice,
				createdAt: selling.createdAt,
				products: sellingProducts,
				payment: {
					id: selling.payment?.id,
					card: new Decimal(selling.payment?.card || 0),
					cash: new Decimal(selling.payment?.cash || 0),
					other: new Decimal(selling.payment?.other || 0),
					transfer: new Decimal(selling.payment?.transfer || 0),
					total: new Decimal(selling.payment?.totalPay || 0),
					description: selling.payment?.description,
					type: ServiceTypeEnum.selling,
					staffId: staffs[selling.seller.id].id,
					userId: clients[selling.client.id].id,
					createdAt: selling.payment?.createdAt || selling.createdAt,
				},
			}
		})

		const arrivalsObject: Record&lt;string, Arrival&gt; &#x3D; {}
		arrivalsRemote.forEach((arrival) &#x3D;&gt; {
			if (!suppliers[arrival.supplier.id]) {
				suppliers[arrival.supplier.id] &#x3D; {
					id: arrival.supplier.id,
					createdAt: arrival.supplier.createdAt,
					fullname: arrival.supplier.name.trim(),
					phone: arrival.supplier.phone.trim(),
					password: bcrypt.hashSync(arrival.supplier.phone.trim(), 7),
					type: UserTypeEnum.supplier,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(arrival.supplier.debt),
					deletedAt: new Date(),
				}
			}

			if (!staffs[arrival.admin.id]) {
				staffs[arrival.admin.id] &#x3D; {
					id: arrival.admin.id,
					createdAt: new Date(),
					fullname: arrival.admin.name.trim(),
					phone: arrival.admin.phone.trim(),
					password: bcrypt.hashSync(arrival.admin.phone.trim(), 7),
					type: UserTypeEnum.staff,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			const arrivalProducts: {
				id: string
				cost: Decimal
				price: Decimal
				count: number
				totalPrice: Decimal
				totalCost: Decimal
				productId: string
				createdAt: Date
				type: ServiceTypeEnum
				staffId: string
				arrivalId: string
			}[] &#x3D; []

			let totalPrice &#x3D; new Decimal(0)
			let totalCost &#x3D; new Decimal(0)
			arrival.incomingProducts.forEach((product) &#x3D;&gt; {
				if (!products[product.product.id]) {
					products[product.product.id] &#x3D; {
						id: product.product.id,
						count: product.product.count,
						name: product.product.name,
						cost: new Decimal(product.cost),
						price: new Decimal(product.selling_price),
						minAmount: 1,
						createdAt: new Date(),
					}
				}
				totalPrice &#x3D; totalPrice.plus(new Decimal(product.selling_price).mul(product.count))
				totalCost &#x3D; totalCost.plus(new Decimal(product.cost).mul(product.count))

				arrivalProducts.push({
					id: product.id,
					arrivalId: arrival.id,
					count: product.count,
					price: new Decimal(product.selling_price),
					cost: new Decimal(product.cost),
					createdAt: product.createdAt,
					type: ServiceTypeEnum.arrival,
					staffId: staffs[arrival.admin.id].id,
					totalCost: new Decimal(new Decimal(product.cost).mul(product.count)),
					totalPrice: new Decimal(new Decimal(product.selling_price).mul(product.count)),
					productId: products[product.product.id].id,
				})
			})

			arrivalsObject[arrival.id] &#x3D; {
				id: arrival.id,
				supplierId: suppliers[arrival.supplier.id].id,
				staffId: staffs[arrival.admin.id].id,
				date: arrival.sellingDate,
				totalPrice: totalPrice,
				totalCost: totalCost,
				createdAt: arrival.createdAt,
				products: arrivalProducts,
				payment: {
					id: arrival.payment?.id,
					card: new Decimal(arrival.payment?.card || 0),
					cash: new Decimal(arrival.payment?.cash || 0),
					other: new Decimal(arrival.payment?.other || 0),
					transfer: new Decimal(arrival.payment?.transfer || 0),
					total: new Decimal(arrival.payment?.totalPay || 0),
					description: arrival.payment?.description,
					type: ServiceTypeEnum.arrival,
					staffId: staffs[arrival.admin.id].id,
					userId: suppliers[arrival.supplier.id].id,
					createdAt: arrival.payment?.createdAt || arrival.createdAt,
				},
			}
		})

		const returningsObject: Record&lt;string, Returning&gt; &#x3D; {}
		returningsRemote.forEach((returning) &#x3D;&gt; {
			if (!clients[returning.client.id]) {
				clients[returning.client.id] &#x3D; {
					id: returning.client.id,
					createdAt: returning.client.createdAt,
					fullname: returning.client.name.trim(),
					phone: returning.client.phone.trim(),
					password: bcrypt.hashSync(returning.client.phone.trim(), 7),
					type: UserTypeEnum.client,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			if (!staffs[returning.seller.id]) {
				staffs[returning.seller.id] &#x3D; {
					id: returning.seller.id,
					createdAt: new Date(),
					fullname: returning.seller.name.trim(),
					phone: returning.seller.phone.trim(),
					password: bcrypt.hashSync(returning.seller.phone.trim(), 7),
					type: UserTypeEnum.staff,
					payments: [],
					balance: new Decimal(0),
					debt: new Decimal(0),
					deletedAt: new Date(),
				}
			}

			const returningProducts: {
				id: string
				price: Decimal
				count: number
				totalPrice: Decimal
				productId: string
				createdAt: Date
				type: ServiceTypeEnum
				staffId: string
				returningId: string
			}[] &#x3D; []

			let totalPrice &#x3D; new Decimal(0)
			returning.products.forEach((product) &#x3D;&gt; {
				if (!products[product.product.id]) {
					products[product.product.id] &#x3D; {
						id: product.product.id,
						count: product.product.count,
						name: product.product.name,
						cost: new Decimal(product.price),
						price: new Decimal(product.price),
						minAmount: 1,
						createdAt: new Date(),
					}
				}
				totalPrice &#x3D; totalPrice.plus(new Decimal(product.price).mul(product.count))

				returningProducts.push({
					id: product.id,
					returningId: returning.id,
					count: product.count,
					price: new Decimal(product.price),
					createdAt: product.createdAt,
					type: ServiceTypeEnum.returning,
					staffId: staffs[returning.seller.id].id,
					totalPrice: new Decimal(product.price).mul(product.count),
					productId: products[product.product.id].id,
				})
			})

			returningsObject[returning.id] &#x3D; {
				id: returning.id,
				clientId: clients[returning.client.id].id,
				staffId: staffs[returning.seller.id].id,
				date: returning.returnedDate,
				totalPrice: totalPrice,
				createdAt: returning.createdAt,
				products: returningProducts,
				payment: {
					id: returning.id,
					fromBalance: new Decimal(returning.fromClient || 0),
					cash: new Decimal(returning.cashPayment || 0),
					total: new Decimal(returning.sum || 0),
					description: returning.description,
					type: ServiceTypeEnum.returning,
					staffId: staffs[returning.seller.id].id,
					userId: clients[returning.client.id].id,
					createdAt: returning.createdAt,
				},
			}
		})

		const arrivals &#x3D; Object.values(arrivalsObject)
		for (const supplier of Object.values(suppliers)) {
			let totalArrivalCost &#x3D; new Decimal(0)
			let totalArrivalPayment &#x3D; new Decimal(0)
			for (const arrival of arrivals) {
				if (arrival.supplierId &#x3D;&#x3D;&#x3D; supplier.id) {
					totalArrivalCost &#x3D; totalArrivalCost.plus(arrival.totalCost)
					totalArrivalPayment &#x3D; totalArrivalPayment.plus(arrival.payment?.total || new Decimal(0))
				}
			}

			const newDebt &#x3D; supplier.balance.minus(totalArrivalCost.minus(totalArrivalPayment))
			const diff &#x3D; supplier.debt.minus(newDebt)

			if (!diff.isZero()) {
				suppliers[supplier.id] &#x3D; {
					...supplier,
					payments: [
						{
							id: uuidv4(),
							total: diff,
							other: diff,
							type: ServiceTypeEnum.supplier,
							userId: supplier.id,
							staffId: mainStaff.id,
							cash: new Decimal(0),
							card: new Decimal(0),
							transfer: new Decimal(0),
							description: &#x60;import qilingan boshlang&#x27;ich qiymat ${diff.toFixed(2)}&#x60;,
							createdAt: new Date(&#x27;01-01-2025&#x27;),
						},
						...supplier.payments,
					],
					balance: supplier.balance.plus(diff),
				}
			}
		}

		const sellings &#x3D; Object.values(sellingsObject)
		for (const client of Object.values(clients)) {
			let totalSellingPrice &#x3D; new Decimal(0)
			let totalSellingPayment &#x3D; new Decimal(0)
			for (const selling of sellings) {
				if (selling.clientId &#x3D;&#x3D;&#x3D; client.id) {
					totalSellingPrice &#x3D; totalSellingPrice.plus(selling.totalPrice)
					totalSellingPayment &#x3D; totalSellingPayment.plus(selling.payment?.total || 0)
				}
			}

			const sellingDebt &#x3D; totalSellingPrice.minus(totalSellingPayment)
			const newDebt &#x3D; sellingDebt.minus(client.balance)

			const diff &#x3D; client.debt.minus(newDebt)

			if (!diff.isZero()) {
				clients[client.id] &#x3D; {
					...client,
					payments: [
						{
							id: uuidv4(),
							total: diff,
							other: diff,
							type: ServiceTypeEnum.client,
							userId: client.id,
							staffId: mainStaff.id,
							cash: new Decimal(0),
							card: new Decimal(0),
							transfer: new Decimal(0),
							description: &#x60;import qilingan boshlang&#x27;ich qiymat ${diff.toFixed(2)}&#x60;,
							createdAt: new Date(&#x27;01-01-2025&#x27;),
						},
						...client.payments,
					],
					balance: client.balance.plus(diff),
				}
			}
		}

		const newStaffs &#x3D; await this.prisma.userModel.createMany({
			skipDuplicates: false,
			data: Object.values(staffs)
				.filter((u) &#x3D;&gt; u.phone &amp;&amp; u.fullname)
				.map((staff) &#x3D;&gt; ({
					id: staff.id,
					balance: staff.balance,
					phone: staff.phone,
					password: staff.password,
					fullname: staff.fullname,
					type: UserTypeEnum.staff,
					createdAt: staff.createdAt,
					deletedAt: staff.deletedAt,
				})),
		})

		const newStaffPayments &#x3D; await this.prisma.paymentModel.createMany({
			skipDuplicates: false,
			data: Object.values(staffs)
				.filter((u) &#x3D;&gt; u.phone &amp;&amp; u.fullname)
				.flatMap((staff) &#x3D;&gt;
					staff.payments.map((payment) &#x3D;&gt; ({
						id: payment.id,
						type: ServiceTypeEnum.staff,
						userId: payment.userId,
						staffId: payment.staffId,
						sum: payment.sum,
						total: payment.total,
						createdAt: payment.createdAt,
						description: payment.description,
					})),
				),
		})

		const newSuppliers &#x3D; await this.prisma.userModel.createMany({
			skipDuplicates: false,
			data: Object.values(suppliers)
				.filter((u) &#x3D;&gt; u.phone &amp;&amp; u.fullname)
				.map((supplier) &#x3D;&gt; ({
					id: supplier.id,
					balance: supplier.balance,
					phone: supplier.phone,
					password: supplier.password,
					fullname: supplier.fullname,
					type: UserTypeEnum.supplier,
					createdAt: supplier.createdAt,
					deletedAt: supplier.deletedAt,
				})),
		})

		const newSupplierPayments &#x3D; await this.prisma.paymentModel.createMany({
			skipDuplicates: false,
			data: Object.values(suppliers)
				.filter((u) &#x3D;&gt; u.phone &amp;&amp; u.fullname)
				.flatMap((supplier) &#x3D;&gt;
					supplier.payments.map((payment) &#x3D;&gt; ({
						id: payment.id,
						type: ServiceTypeEnum.supplier,
						userId: payment.userId,
						staffId: payment.staffId,
						cash: payment.cash,
						card: payment.card,
						other: payment.other,
						transfer: payment.transfer,
						total: payment.total,
						createdAt: payment.createdAt,
						description: payment.description,
					})),
				),
		})

		const newClients &#x3D; await this.prisma.userModel.createMany({
			skipDuplicates: false,
			data: Object.values(clients)
				.filter((u) &#x3D;&gt; u.phone &amp;&amp; u.fullname)
				.map((client) &#x3D;&gt; ({
					id: client.id,
					balance: client.balance,
					phone: client.phone,
					password: client.password,
					fullname: client.fullname,
					type: UserTypeEnum.client,
					createdAt: client.createdAt,
					deletedAt: client.deletedAt,
				})),
		})

		const newClientPayments &#x3D; await this.prisma.paymentModel.createMany({
			skipDuplicates: false,
			data: Object.values(clients)
				.filter((u) &#x3D;&gt; u.phone &amp;&amp; u.fullname)
				.flatMap((client) &#x3D;&gt;
					client.payments.map((payment) &#x3D;&gt; ({
						id: payment.id,
						type: ServiceTypeEnum.client,
						userId: payment.userId,
						staffId: payment.staffId,
						cash: payment.cash,
						card: payment.card,
						other: payment.other,
						transfer: payment.transfer,
						total: payment.total,
						createdAt: payment.createdAt,
						description: payment.description,
					})),
				),
		})

		const newProducts &#x3D; await this.prisma.productModel.createMany({
			skipDuplicates: false,
			data: Object.values(products).map((product) &#x3D;&gt; ({
				id: product.id,
				name: product.name,
				cost: product.cost,
				price: product.price,
				count: product.count,
				minAmount: product.minAmount,
				createdAt: product.createdAt,
			})),
		})

		// Arrivals
		const newArrivals &#x3D; await this.prisma.arrivalModel.createMany({
			skipDuplicates: false,
			data: Object.values(arrivalsObject).map((arrival) &#x3D;&gt; ({
				id: arrival.id,
				supplierId: arrival.supplierId,
				staffId: arrival.staffId,
				date: arrival.date,
				totalPrice: arrival.totalPrice,
				totalCost: arrival.totalCost,
				createdAt: arrival.createdAt,
			})),
		})

		// Arrival Products
		await this.prisma.productMVModel.createMany({
			skipDuplicates: false,
			data: Object.values(arrivalsObject).flatMap((arrival) &#x3D;&gt;
				arrival.products.map((product) &#x3D;&gt; ({
					id: product.id,
					productId: product.productId,
					arrivalId: arrival.id,
					type: product.type,
					staffId: product.staffId,
					count: product.count,
					cost: product.cost,
					price: product.price,
					totalPrice: product.totalPrice,
					totalCost: product.totalCost,
					createdAt: product.createdAt,
				})),
			),
		})

		// Arrival Payments
		await this.prisma.paymentModel.createMany({
			skipDuplicates: false,
			data: Object.values(arrivalsObject)
				.filter((a) &#x3D;&gt; a.payment)
				.map((arrival) &#x3D;&gt; ({
					id: arrival.payment.id,
					type: ServiceTypeEnum.arrival,
					arrivalId: arrival.id,
					userId: arrival.payment.userId,
					staffId: arrival.payment.staffId,
					cash: arrival.payment.cash,
					card: arrival.payment.card,
					other: arrival.payment.other,
					transfer: arrival.payment.transfer,
					total: arrival.payment.total,
					createdAt: arrival.payment.createdAt,
					description: arrival.payment.description,
				})),
		})

		// Sellings
		const newSellings &#x3D; await this.prisma.sellingModel.createMany({
			skipDuplicates: false,
			data: Object.values(sellingsObject)
				.filter((s) &#x3D;&gt; s.clientId)
				.map((selling) &#x3D;&gt; ({
					id: selling.id,
					clientId: selling.clientId,
					staffId: selling.staffId,
					date: selling.date,
					totalPrice: selling.totalPrice,
					status: selling.status,
					createdAt: selling.createdAt,
				})),
		})

		// Selling Products
		await this.prisma.productMVModel.createMany({
			skipDuplicates: false,
			data: Object.values(sellingsObject).flatMap((selling) &#x3D;&gt;
				selling.products.map((product) &#x3D;&gt; ({
					id: product.id,
					productId: product.productId,
					sellingId: selling.id,
					type: product.type,
					staffId: product.staffId,
					count: product.count,
					price: product.price,
					totalPrice: product.totalPrice,
					createdAt: product.createdAt,
				})),
			),
		})

		// Selling Payments
		await this.prisma.paymentModel.createMany({
			skipDuplicates: false,
			data: Object.values(sellingsObject)
				.filter((s) &#x3D;&gt; s.payment)
				.map((selling) &#x3D;&gt; ({
					id: selling.payment.id,
					type: ServiceTypeEnum.selling,
					userId: selling.payment.userId,
					staffId: selling.payment.staffId,
					sellingId: selling.id,
					cash: selling.payment.cash,
					card: selling.payment.card,
					other: selling.payment.other,
					transfer: selling.payment.transfer,
					total: selling.payment.total,
					createdAt: selling.payment.createdAt,
					description: selling.payment.description,
				})),
		})

		// Returnings
		const newReturnings &#x3D; await this.prisma.returningModel.createMany({
			skipDuplicates: false,
			data: Object.values(returningsObject).map((returning) &#x3D;&gt; ({
				id: returning.id,
				clientId: returning.clientId,
				staffId: returning.staffId,
				date: returning.date,
				totalPrice: returning.totalPrice,
				createdAt: returning.createdAt,
			})),
		})

		// Returning Products
		await this.prisma.productMVModel.createMany({
			skipDuplicates: false,
			data: Object.values(returningsObject).flatMap((returning) &#x3D;&gt;
				returning.products.map((product) &#x3D;&gt; ({
					id: product.id,
					productId: product.productId,
					returningId: returning.id,
					type: product.type,
					staffId: product.staffId,
					count: product.count,
					price: product.price,
					totalPrice: product.totalPrice,
					createdAt: product.createdAt,
				})),
			),
		})

		// Returning Payments
		await this.prisma.paymentModel.createMany({
			skipDuplicates: false,
			data: Object.values(returningsObject).map((returning) &#x3D;&gt; ({
				id: returning.payment.id,
				type: ServiceTypeEnum.returning,
				userId: returning.payment.userId,
				returningId: returning.id,
				staffId: returning.payment.staffId,
				fromBalance: returning.payment.fromBalance,
				cash: returning.payment.cash,
				total: returning.payment.total,
				createdAt: returning.payment.createdAt,
				description: returning.payment.description,
			})),
		})
		console.log(newStaffs.count, newSuppliers.count, newClients.count, newProducts.count)
		console.log(newStaffPayments.count, newSupplierPayments.count, newClientPayments.count)
		console.log(newSellings.count, newArrivals.count, newReturnings.count)

		return createResponse({ data: {}, success: { messages: [&#x27;syncronize success&#x27;] } })
	}
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'Syncronize2Service.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
